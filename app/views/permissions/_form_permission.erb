<%= form_tag({action: 'submit'}, {remote: true, :'data-type' => 'json', id: "permissionsByRight", :class => "form-horizontal"}) do |f| %>
  <div class="control-group">
    <div class="controls">
      <%= hidden_field_tag 'type', 'permission' %>
      <%= select_tag 'permission', options_for_select(@categories.map { |cat| [t('permissions.' + cat), cat]}), {class: 'selectpicker', id: 'permissions'} %>
      <h4><%= t('permissions.permission_on', permission: t('permissions.approve_events'), subject: Room.model_name.human.pluralize.titleize) %></h4>
      <%= select_tag 'rooms[approve_events][]',
          options_for_select({'All' => 'all'}, 'all') + options_from_collection_for_select(Room.all, :id, :name),
          { :class => 'selectpicker', id: 'rooms', :multiple => '', :'data-live-search' => "true" }%>
      
      <div id="entitiesDiv"></div>
      <script>
        $(function() {
          $('#permissions').ready(updatePermittedEntities);
          $(document).on('ajax:success', '#permissionsByRight', permissionSubmitSuccess);
          $('#rooms').prop('disabled', !($('#permissions').val() == 'approve_events')).selectpicker('refresh');
          $('#permissions').change(function() {
            $('#rooms').prop('disabled', !($(this).val() == 'approve_events')).selectpicker('refresh');
          })
        })
      </script>

      <%= submit_tag nil, :class => 'btn btn-primary' %>
      <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
              permissions_path, :class => 'btn btn-default' %>

    </div>
  </div>
  <br></br>
  

<% end %>